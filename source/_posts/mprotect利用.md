---
title: mprotect利用
date: '2025-02-24 18:35:27'
updated: '2025-04-07 21:39:55'
---
mprotect 函数是一个系统调用，用于改变一块内存区域的保护属性，通常用于设置该区域是否可读、可写、可执行等。这个函数的原型在 <sys/mman.h> 头文件中定义，格式如下：

`int mprotect(void *addr, size_t len, int prot);`

参数解释：

1. void *addr：

指向内存区域的起始地址。该地址必须是页面大小（通常为 4096 字节）的整数倍。通常传递一个指向内存区域的指针，表示需要更改权限的内存区域的起始地址。

2. size_t len：

要修改保护属性的内存区域的长度（字节数）。它指定了从 addr 开始的内存区域的大小，必须是页面大小的整数倍。

3. int prot：

内存区域的新保护属性。这个参数是一个位掩码，可以是以下几个常量的组合，定义了内存的访问权限：

+ PROT_READ：允许读取内存区域。
+ PROT_WRITE：允许写入内存区域。
+ PROT_EXEC：允许执行内存区域。
+ PROT_NONE：禁止访问内存区域。

这些标志可以通过按位或 (|) 操作组合在一起使用。例如，可以将 PROT_READ | PROT_WRITE 组合起来，表示该区域既可以读取，也可以写入。

