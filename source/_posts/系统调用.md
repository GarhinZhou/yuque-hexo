---
title: 系统调用
date: '2024-12-27 18:26:11'
updated: '2025-04-07 21:39:55'
---
## 0x01 不同架构的系统调用机制
### x86 架构（32 位）
系统调用号：存放在`EAX` 寄存器中。

参数：

第一个参数：`EBX`

第二个参数：`ECX`

第三个参数：`EDX`

第四个参数：`ESI`

第五个参数：`EDI`

第六个参数：`EBP`

返回地址：`ECX`

### x86_64 架构（64 位）
系统调用号：存放在 `RAX` 寄存器中。

参数：

第一个参数：`RDI`

第二个参数：`RSI`

第三个参数：`RDX`

第四个参数：`R10`  //注意不是 `RCX`

第五个参数：`R8`

第六个参数：`R9`

返回地址：`RCX`

> 为什么第四个参数不是放在 RCX 寄存器？
>
> 在 x86_64 架构上，RCX 寄存器在系统调用中有特殊用途。具体来说，RCX 寄存器在执行 syscall 指令时会被用来保存返回地址。因此，Linux 系统调用约定选择使用 R10 而不是 RCX 来传递第四个参数，以避免冲突。
>

### ARM 架构
系统调用号：存放在 `R7` 寄存器中（对于 ARM EABI）。

参数：

第一个参数：`R0`

第二个参数：`R1`

第三个参数：`R2`

第四个参数：`R3`

第五个参数：`R4`

第六个参数：`R5`

返回地址：`LR`（Link Register）

### AArch64 架构（64 位 ARM）
系统调用号：存放在 `X8` 寄存器中。

参数：

第一个参数：`X0`

第二个参数：`X1`

第三个参数：`X2`

第四个参数：`X3`

第五个参数：`X4`

第六个参数：`X5`

返回地址：`LR`（Link Register）

### MIPS 架构
系统调用号：存放在 `v0` 寄存器中。

参数：

第一个参数：`a0`

第二个参数：`a1`

第三个参数：`a2`

第四个参数：`a3`

额外的参数通过栈传递。

返回地址：`ra`（return address）

### PowerPC 架构
系统调用号：存放在 `r0` 寄存器中。

参数：

第一个参数：`r3`

第二个参数：`r4`

第三个参数：`r5`

第四个参数：`r6`

第五个参数：`r7`

第六个参数：`r8`

第七个参数：`r9`

第八个参数：`r10`

返回地址：`LR`（Link Register）

## 0x02 系统调用号
[系统调用号](https://www.jianshu.com/p/8da8cbcce815)

