---
title: VMware
date: '2024-12-11 19:43:46'
updated: '2025-05-29 23:57:40'
---
[来自CSDN](https://blog.csdn.net/qq_54218833/article/details/125241618)

## 虚拟机日常维护注意事项
在最新的VMware中对虚拟机有一个保护选项，可以在指定时间间隔内保存一个快照，这样在虚拟机崩溃的时候能够快速回档到前两天的快照中，有效减少文件等的损失，而不必每次都手动保存快照。

![](/images/836019e04d456ac9abece3d555569af9.png)

如上图所示，在虚拟机设置->选项中可以找到自动保护选项，根据你设置的保护间隔和最大自动保护快照数量可以计算出至少需要的磁盘空间，因此需要保证有足够的磁盘空间。

另外，当虚拟机存在快照时，是不能扩充磁盘容量的，因此要想扩充虚拟机的虚拟磁盘，要么在创建虚拟机时就分配足够大小的磁盘空间，要么就只能删除所有的快照后再进行扩充（建议前者，因为有的快照删除特别慢，如果快照多的话可能要等很长时间）

## 从零搭建环境
下面就将介绍如何从零搭建一个CTF-pwn环境（由于学习仍在进行，故一些环境如远程执行环境还没有搭建的经历，如今后需要搭建，会在最后进行补充）



1. 创建虚拟机

可以在ubuntu官方网站上下载最新的长期支持版本，在笔者写这篇文章的时候，这个版本已经是22.04了，但还是按照20.04的版本来安装。22.04下载/历史版本下载

![](/images/6e639c810ae45e4a81291d2b6703ed5d.png)

下载的是光盘映像文件，将其放在虚拟机的工作目录中。

然后选择vmware上方工具栏的文件->新建虚拟机，打开新建虚拟机向导。如下：

![](/images/76a20b7b1db1e51bd517a34c09a46055.png)

选择自定义安装，点击下一步。

![](/images/fd29116c3ada499787589742fbcd7ad1.png)

硬件兼容性不需要改，一般默认选择最新的vmware版本兼容，你的vmware是什么版本就用什么版本，不用修改，直接点击下一步。

![](/images/9969cd484ef88dc76fd195e177b1df48.png)

选择安装程序光盘映像文件，点击浏览，选择你刚才下载的映像文件，然后点击下一步。

![](/images/8f13b94378ebb95c7386507166745f9d.png)

输入全名（这个随便输，想输什么都行），以及你登录虚拟机的用户名和密码。之后点击下一步。

![](/images/797b5f42562c44c198271323f1cdd99e.png)

输入虚拟机的名字，将位置浏览设置为你的虚拟机工作目录。

![](/images/2a0f6d1590009423df2bdb40ad389479.png)

处理器数量选择。如果你的电脑配置很好而且虚拟机也需要一定的计算需要，可以设置多一些，内核数量不变，修改处理器数量。但是总数不能超过你电脑主机的内核数量。我一般选择8处理器。

![](/images/0129b41b13bc948f5cbe4eafb1a7141d.png)

内存大小设置。同样看主机的配置。最好不要超过主机的内存大小，否则虚拟机可能会变慢。对于pwn做题来说4GB一般就足够了。

![](/images/1f0fc86053a8aea189273b55ef712c1c.png)

网络选择。这个网络的选择可以在虚拟机创建之后随时修改，这里简单介绍一下最常用的前两种：桥接网络和NAT。桥接网络如上面所说，直接访问外部以太网，前提是虚拟机要有自己的IP地址，因此桥接网络在使用的时候大多都是勾选“与主机共用IP地址”这个选项（这个选项在创建虚拟机到这一步的时候没有显示，但是可以在上方工具栏虚拟机->设置中找到并勾选，后面再说）。某些学校的校园网可能有接入设备数量限制（笔者学校就是），这个时候虚拟机选择桥接网络可能无法联网，可以考虑使用NAT模式，在这个模式下，主机相当于一个网关，而虚拟机为网关下的机器，与外部以太网连接需要借助主机。这种模式可以有效克服上面说的校园网接入数量限制问题。

因此这里选择默认NAT，最好能够保证开机之后立刻联网呃，因为需要下载一些包，安装完成之后也能改。以默认NAT进行下一步。

![](/images/a1c3d4538f0e8f1698d3a676d5fa2a5d.png)

IO控制器类型，不用改直接下一步。

![](/images/b47c1cfbb971185ff4a17de099a0cb90.png)

磁盘类型也不用改，直接下一步。

![](/images/d9d942c792a996ad4abce30a66a2cdda.png)

磁盘类型不用改，下一步。

![](/images/6510c7322350294068885e12d5c11c79.png)

磁盘空间设置这里，除了最大磁盘大小之外其他都不要改。为了避免出现磁盘空间不足的问题，笔者这里设置为200GB。这个大小根据自己的物理磁盘空间决定，但是不要太小，建议pwner们不要小于60GB，后面做kernel pwn搭建环境可能很占空间的。

![](/images/03bf864a1dd9a88b4faf25379a7ba5ab.png)

磁盘文件，不用改直接下一步。

![](/images/9ac13b74a407f389774cbe7ea3ed54bd.png)

上面是最后确认的界面，确定好虚拟机的配置后，点击完成就可以开始创建虚拟机了。

![](/images/a073a81d04350ec62111da89123e7706.png)

之后是自动开机安装过程，耐心等待一段时间…

![](/images/4ed224c42dacbba88ff0d2bf2363444f.png)

大约10分钟之后，我们就能够登录ubuntu系统了。

![](/images/c4692c11d9d9eb1cca9750890336c474.png)

在笔者的vmware中，linux系统在安装的时候就已经安装了VMware Tools，它能够帮助你更加快捷地在主机和虚拟机中传递文件，只需拖动即可。但是笔者的虚拟机只能从打开的文件夹中拖动文件到主机，不能从桌面上直接拖动复制，从主机复制文件到虚拟机也是必须复制到打开的文件夹中。

自此，我们的ubuntu系统就成功搭建好了，下面进行一些配置使虚拟机能够更加轻松方便地使用。

## MacOS 安装
### VMware-MacOS 补丁
github 项目：[https://github.com/DrDonk/unlocker](https://github.com/DrDonk/unlocker)

安装下来之后，在保证 VMware 完全关闭（没有任何服务和后台）的情况下，用管理员权限运行 `unlock.exe`

运行成功之后 VMware 就启动了，这时候新建虚拟机-自定义选好镜像之后里面就可以选择 MacOS 安装了，配置上建议至少 8 核 16G 内存 80G 存储

### 启动之后配置
先弄好磁盘再安装

![](/images/074a98da226e574fc0112519172d60ec.png)

![](/images/beed39a070dbf7e908a05576fd5337aa.png)

![](/images/892619731146cbbcb0bde4ae0cf9e6bf.png)

![](/images/a8aaacf6ea69161666900be8d55390d8.png)

这里大概会卡上一会：

![](/images/e23570fad2fc210c56c37748149ee99b.png)

接着就进到引导界面了：

![](/images/9d926bdf9242e147b47d3b25ed645f18.png)

![](/images/8df10025309c76313936950c9652ac29.png)

![](/images/4d7dbbce6e22caf586455f2270c65000.png)

![](/images/1802fda63a3aff4d49fc5598ec823756.png)

![](/images/e0cc9aeee542f4042532d9f339a9ad41.png)

### 联网
先关机，在主机上面打开`VMware DHCP Services`和`VMware NAT Services`，然后开机就有网了

![](/images/69219870bfc86189cca94dc0045561e4.png)

### 安装 VMware Tools
先弹出安装盘

![](/images/d7424fad047837b82a79f6c56c04db95.png)

在虚拟机联网的前提下在 VMware 的界面点`虚拟机`-`安装 VMwareTools(T)`，然后再在虚拟机里面双击`安装 VMwareTools`

![](/images/ea22922f2560d1c659bcae06a0133344.png)

但是系统会象征性地拦一下：

![](/images/d8d732b41cfb8fa2d70ec39bfb53c217.png)

![](/images/6e0ef5cf352895818484901aa480f8fa.png)

![](/images/3a79cfdef05b94c4efa647ba84bbe5dc.png)

![](/images/8d65f74da45f673038a905d875cdd3b4.png)

![](/images/53be8a68f5e59c8a8361e43d72682196.png)

![](/images/9228cf94c2cc54341718f2ef67a3d3b1.png)

就搞定啦~

![](/images/28195454a5b282294d4279db6d46e239.png)

